stages:
# Clean up branches made to validate Arcade on bellwether repos
- stage: Clean_Up_Arcade_Branches_On_Consumer_Repositories
  displayName: Clean Up Arcade Branches On Consumer Repositories
  jobs:
    - template: /eng/common/templates/job/job.yml
      parameters:
        name: Clean_Up_Arcade_Branches_On_Consumer_Repositories
        displayName: Clean Up Arcade Branches On Consumer Repositories
        timeoutInMinutes: 240
        pool: 
          vmImage: vs2017-win2016
        variables:
          - group: Publish-Build-Assets
          - group: DotNetBot-GitHub
          - group: DotNet-Blob-Feed
          - group: DotNet-Symbol-Server-Pats
          - group: DotNet-VSTS-Infra-Access
        strategy:
          matrix:
            CleanUpRuntime:
              _githubRepoName: "runtime"
              _azdoRepoName: "dotnet-runtime"
            CleanUpASPNETCore:
              _githubRepoName: "aspnetcore"
              _azdoRepoName: "dotnet-aspnetcore"
            CleanUpInstaller:
              _githubRepoName: "installer"
              _azdoRepoName: "dotnet-installer"
        steps:
          - checkout: self
            clean: true
          - powershell: eng\validation\remove-oldbranches.ps1
              -azdoOrg "dnceng"
              -azdoProject "internal"
              -azdoToken $(dn-bot-dnceng-build-rw-code-rw)
              -githubUser "dotnet-bot"
              -githubPAT $(BotAccount-dotnet-bot-repo-PAT)
              -githubOrg "dotnet"
              -githubRepoName $(_githubRepoName)
              -barToken $(MaestroAccessToken)
              -azdoRepoName $(_azdoRepoName)
            displayName: Clean Up Arcade Branches On Consumer Repositories
            name: Clean_Up_Arcade_Branches_On_Consumer_Repositories